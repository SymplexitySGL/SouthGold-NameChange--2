USE [Sibanye Gold Limited];

DISABLE TRIGGER ALL ON [Oug Budgeted Complement Revised Plan];

DISABLE TRIGGER ALL ON [Oug Budgeted Complement Business Plan];


SET NOCOUNT ON

DECLARE @TBL TABLE	([ID]	INT IDENTITY(1,1), [TableName] NVARCHAR(50));
DECLARE @SELECT NVARCHAR(MAX),
		@INSERT NVARCHAR(MAX),
		@FROM NVARCHAR(MAX),
		@WHERE NVARCHAR(MAX),
		@OldName NVARCHAR(50),
		@NewName NVARCHAR(50),
		@OldRT INT,
		@NewRT INT;


SET @OldName = 'Southgold'
SET @NewName = 'SG Eastern Operations'
SELECT @OldRT = [Resource Tag] FROM [Resource] WHERE [Resource Reference] = @OldName
SELECT @NewRT = [Resource Tag] FROM [Resource] WHERE [Resource Reference] = @NewName



INSERT INTO @TBL (TableName)
SELECT 'Opr Unit Discipline'


SELECT	@SELECT = ISNULL(@SELECT, ' SELECT ') + CASE  WHEN SC.name LIKE '%Resource Tag%' THEN 'RX.[Resource Tag],'
													WHEN ST.name LIKE '%Char%' THEN 'REPLACE(X.['+SC.NAME+'], '''+@OldName+''', '''+@NewName+'''), '
													WHEN ST.name NOT LIKE '%Char%' THEN 'X.['+SC.NAME+'],' 
											  END,
		@INSERT = ISNULL(@INSERT, ' INSERT INTO ['+SO.name+'] (')+ '['+SC.NAME+'], ',
		@FROM = ' FROM ['+SO.NAME+'] X JOIN [Resource] R ON X.[Resource Tag] = R.[Resource Tag] JOIN [Resource] RX ON RX.[Resource Reference] = REPLACE(R.[Resource Reference], '''+@OldName+''', '''+@NewName+''')',
		@WHERE = ISNULL(@WHERE, ' WHERE ') + CASE WHEN SC.NAME LIKE '%resource%tag%' THEN 'R.[Resource Reference]' ELSE 'X.['+SC.Name +'] ' END + ' '+ CASE WHEN SC.name LIKE '%Resource%Tag%' THEN 'LIKE ''%'+@OldName+'%'' OR ' ELSE' LIKE ''%'+@OldName+'%'' OR ' END


--SO.name, , ST.name, SCH.name
FROM	sysobjects SO
		JOIN syscolumns SC
		ON SO.id = SC.id
		JOIN @TBL T
		ON T.TableName = SO.name
		AND SO.name = T.[TableName]
		AND SO.type = 'u'
		JOIN sys.systypes ST
		ON SC.xtype = ST.xtype
		--AND SC.type = ST.type
		JOIN sys.schemas SCH
		ON SO.uid = SCH.schema_id
		LEFT JOIN sys.identity_columns IC
		ON SO.id = IC.object_id
		AND SC.colid = column_id
WHERE	(ST.name LIKE '%CHAR%'
	OR ST.name LIKE '%INT%'
	OR ST.name LIKE '%Date%'
	OR ST.name LIKE '%float%')
	AND IC.name IS NULL
	--OR SC.name LIKE '%resource%tag%'

ORDER BY SC.colid


SELECT	@INSERT = LEFT(@INSERT, LEN(@INSERT)-1)+ ')'
SELECT  @SELECT = LEFT(@SELECT, LEN(@SELECT)-1)
SELECT  @WHERE = LEFT(@WHERE, LEN(@WHERE)-3)

SELECT	@INSERT +CHAR(13)+ @SELECT +CHAR(13)+ @FROM +CHAR(13)+ @WHERE

--01	---NOTE WHERE CLAUSE
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 INSERT INTO [OUG Discipline] ([Resource Tag], [Operation], [Start Date], [End Date], [Main Discipline Group], [Discipline], [Sub Discipline], [Reporting Discipline], [Group Main Discipline], [Group Sub Discipline])
 SELECT RX.[Resource Tag],REPLACE(X.[Operation], @OldName, @NewName), X.[Start Date],X.[End Date],REPLACE(X.[Main Discipline Group], @OldName, @NewName), REPLACE(X.[Discipline], @OldName, @NewName), REPLACE(X.[Sub Discipline], @OldName, @NewName), REPLACE(X.[Reporting Discipline], @OldName, @NewName), REPLACE(X.[Group Main Discipline], @OldName, @NewName), REPLACE(X.[Group Sub Discipline], @OldName, @NewName)
 FROM [OUG Discipline] X JOIN [Resource] R ON X.[Resource Tag] = R.[Resource Tag] JOIN [Resource] RX ON RX.[Resource Reference] = REPLACE(R.[Resource Reference], @OldName, @NewName)
 WHERE R.[Resource Reference] LIKE '%'+@OldName+'%' OR X.[Operation]   LIKE '%'+@OldName+'%' --OR X.[Start Date]   LIKE '%'+@OldName+'%' OR X.[End Date]   LIKE '%'+@OldName+'%' OR X.[Main Discipline Group]   LIKE '%'+@OldName+'%' OR X.[Discipline]   LIKE '%'+@OldName+'%' OR X.[Sub Discipline]   LIKE '%'+@OldName+'%' OR X.[Reporting Discipline]   LIKE '%'+@OldName+'%' OR X.[Group Main Discipline]   LIKE '%'+@OldName+'%' OR X.[Group Sub Discipline]   LIKE '%'+@OldName+'%'


-- SELECT RX.[Resource Tag],REPLACE(X.[Operation], 'gfps', 'SGS'), X.[Start Date],X.[End Date],REPLACE(X.[Main Discipline Group], 'gfps', 'SGS'), REPLACE(X.[Discipline], 'gfps', 'SGS'), REPLACE(X.[Sub Discipline], 'gfps', 'SGS'), REPLACE(X.[Reporting Discipline], 'gfps', 'SGS'), REPLACE(X.[Group Main Discipline], 'gfps', 'SGS'), REPLACE(X.[Group Sub Discipline], 'gfps', 'SGS')
-- FROM [OUG Discipline] X JOIN [Resource] R ON X.[Resource Tag] = R.[Resource Tag] JOIN [Resource] RX ON RX.[Resource Reference] = REPLACE(R.[Resource Reference], 'gfps', 'SGS')
-- WHERE R.[Resource Reference] LIKE '%'+'gfps'+'%' OR X.[Operation]   LIKE '%'+'gfps'+'%' --OR X.[Start Date]   LIKE '%'+'gfps'+'%' OR X.[End Date]   LIKE '%'+'gfps'+'%' OR X.[Main Discipline Group]   LIKE '%'+'gfps'+'%' OR X.[Discipline]   LIKE '%'+'gfps'+'%' OR X.[Sub Discipline]   LIKE '%'+'gfps'+'%' OR X.[Reporting Discipline]   LIKE '%'+'gfps'+'%' OR X.[Group Main Discipline]   LIKE '%'+'gfps'+'%' OR X.[Group Sub Discipline]   LIKE '%'+'gfps'+'%'

--SELECT * FROM [OUG Discipline] WHERE	[operation] = 'SGS'

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 --02


 INSERT INTO [Oug Budgeted Complement Business Plan] ([Resource Tag], [Budget Year], [Designation], [Leave Complement Percentage], [Development Complement Percentage], [Jul Complement (At Work)], [Jul Leave Complement], [Jul Complement (In Service)], [Aug Percentage Adjustment], [Aug Complement Adjustment], [Aug Complement (At Work)], [Aug Leave Complement], [Aug Complement (In Service)], [Sep Percentage Adjustment], [Sep Complement Adjustment], [Sep Complement (At Work)], [Sep Leave Complement], [Sep Complement (In Service)], [Oct Percentage Adjustment], [Oct Complement Adjustment], [Oct Complement (At Work)], [Oct Leave Complement], [Oct Complement (In Service)], [Nov Percentage Adjustment], [Nov Complement Adjustment], [Nov Complement (At Work)], [Nov Leave Complement], [Nov Complement (In Service)], [Dec Percentage Adjustment], [Dec Complement Adjustment], [Dec Complement (At Work)], [Dec Leave Complement], [Dec Complement (In Service)], [Jan Percentage Adjustment], [Jan Complement Adjustment], [Jan Complement (At Work)], [Jan Leave Complement], [Jan Complement (In Service)], [Feb Percentage Adjustment], [Feb Complement Adjustment], [Feb Complement (At Work)], [Feb Leave Complement], [Feb Complement (In Service)], [Mar Percentage Adjustment], [Mar Complement Adjustment], [Mar Complement (At Work)], [Mar Leave Complement], [Mar Complement (In Service)], [Apr Percentage Adjustment], [Apr Complement Adjustment], [Apr Complement (At Work)], [Apr Leave Complement], [Apr Complement (In Service)], [May Percentage Adjustment], [May Complement Adjustment], [May Complement (At Work)], [May Leave Complement], [May Complement (In Service)], [Jun Percentage Adjustment], [Jun Complement Adjustment], [Jun Complement (At Work)], [Jun Leave Complement], [Jun Complement (In Service)], [Approved - Gang Level], [GFL Approval], [Org Unit - Gang], [Jul Complement Adjustment], [Jul Percentage Adjustment])
 SELECT RX.[Resource Tag],REPLACE(X.[Budget Year], @OldName, @NewName), REPLACE(X.[Designation], @OldName, @NewName), X.[Leave Complement Percentage],X.[Development Complement Percentage],X.[Jul Complement (At Work)],X.[Jul Leave Complement],X.[Jul Complement (In Service)],X.[Aug Percentage Adjustment],X.[Aug Complement Adjustment],X.[Aug Complement (At Work)],X.[Aug Leave Complement],X.[Aug Complement (In Service)],X.[Sep Percentage Adjustment],X.[Sep Complement Adjustment],X.[Sep Complement (At Work)],X.[Sep Leave Complement],X.[Sep Complement (In Service)],X.[Oct Percentage Adjustment],X.[Oct Complement Adjustment],X.[Oct Complement (At Work)],X.[Oct Leave Complement],X.[Oct Complement (In Service)],X.[Nov Percentage Adjustment],X.[Nov Complement Adjustment],X.[Nov Complement (At Work)],X.[Nov Leave Complement],X.[Nov Complement (In Service)],X.[Dec Percentage Adjustment],X.[Dec Complement Adjustment],X.[Dec Complement (At Work)],X.[Dec Leave Complement],X.[Dec Complement (In Service)],X.[Jan Percentage Adjustment],X.[Jan Complement Adjustment],X.[Jan Complement (At Work)],X.[Jan Leave Complement],X.[Jan Complement (In Service)],X.[Feb Percentage Adjustment],X.[Feb Complement Adjustment],X.[Feb Complement (At Work)],X.[Feb Leave Complement],X.[Feb Complement (In Service)],X.[Mar Percentage Adjustment],X.[Mar Complement Adjustment],X.[Mar Complement (At Work)],X.[Mar Leave Complement],X.[Mar Complement (In Service)],X.[Apr Percentage Adjustment],X.[Apr Complement Adjustment],X.[Apr Complement (At Work)],X.[Apr Leave Complement],X.[Apr Complement (In Service)],X.[May Percentage Adjustment],X.[May Complement Adjustment],X.[May Complement (At Work)],X.[May Leave Complement],X.[May Complement (In Service)],X.[Jun Percentage Adjustment],X.[Jun Complement Adjustment],X.[Jun Complement (At Work)],X.[Jun Leave Complement],X.[Jun Complement (In Service)],REPLACE(X.[Approved - Gang Level], @OldName, @NewName), REPLACE(X.[GFL Approval], @OldName, @NewName), REPLACE(X.[Org Unit - Gang], @OldName, @NewName), X.[Jul Complement Adjustment],X.[Jul Percentage Adjustment]
 FROM [Oug Budgeted Complement Business Plan] X JOIN [Resource] R ON X.[Resource Tag] = R.[Resource Tag] JOIN [Resource] RX ON RX.[Resource Reference] = REPLACE(R.[Resource Reference], @OldName, @NewName)
 WHERE R.[Resource Reference] LIKE '%'+@OldName+'%' OR X.[Budget Year]   LIKE '%'+@OldName+'%' OR X.[Designation]   LIKE '%'+@OldName+'%' OR X.[Leave Complement Percentage]   LIKE '%'+@OldName+'%' OR X.[Development Complement Percentage]   LIKE '%'+@OldName+'%' OR X.[Jul Complement (At Work)]   LIKE '%'+@OldName+'%' OR X.[Jul Leave Complement]   LIKE '%'+@OldName+'%' OR X.[Jul Complement (In Service)]   LIKE '%'+@OldName+'%' OR X.[Aug Percentage Adjustment]   LIKE '%'+@OldName+'%' OR X.[Aug Complement Adjustment]   LIKE '%'+@OldName+'%' OR X.[Aug Complement (At Work)]   LIKE '%'+@OldName+'%' OR X.[Aug Leave Complement]   LIKE '%'+@OldName+'%' OR X.[Aug Complement (In Service)]   LIKE '%'+@OldName+'%' OR X.[Sep Percentage Adjustment]   LIKE '%'+@OldName+'%' OR X.[Sep Complement Adjustment]   LIKE '%'+@OldName+'%' OR X.[Sep Complement (At Work)]   LIKE '%'+@OldName+'%' OR X.[Sep Leave Complement]   LIKE '%'+@OldName+'%' OR X.[Sep Complement (In Service)]   LIKE '%'+@OldName+'%' OR X.[Oct Percentage Adjustment]   LIKE '%'+@OldName+'%' OR X.[Oct Complement Adjustment]   LIKE '%'+@OldName+'%' OR X.[Oct Complement (At Work)]   LIKE '%'+@OldName+'%' OR X.[Oct Leave Complement]   LIKE '%'+@OldName+'%' OR X.[Oct Complement (In Service)]   LIKE '%'+@OldName+'%' OR X.[Nov Percentage Adjustment]   LIKE '%'+@OldName+'%' OR X.[Nov Complement Adjustment]   LIKE '%'+@OldName+'%' OR X.[Nov Complement (At Work)]   LIKE '%'+@OldName+'%' OR X.[Nov Leave Complement]   LIKE '%'+@OldName+'%' OR X.[Nov Complement (In Service)]   LIKE '%'+@OldName+'%' OR X.[Dec Percentage Adjustment]   LIKE '%'+@OldName+'%' OR X.[Dec Complement Adjustment]   LIKE '%'+@OldName+'%' OR X.[Dec Complement (At Work)]   LIKE '%'+@OldName+'%' OR X.[Dec Leave Complement]   LIKE '%'+@OldName+'%' OR X.[Dec Complement (In Service)]   LIKE '%'+@OldName+'%' OR X.[Jan Percentage Adjustment]   LIKE '%'+@OldName+'%' OR X.[Jan Complement Adjustment]   LIKE '%'+@OldName+'%' OR X.[Jan Complement (At Work)]   LIKE '%'+@OldName+'%' OR X.[Jan Leave Complement]   LIKE '%'+@OldName+'%' OR X.[Jan Complement (In Service)]   LIKE '%'+@OldName+'%' OR X.[Feb Percentage Adjustment]   LIKE '%'+@OldName+'%' OR X.[Feb Complement Adjustment]   LIKE '%'+@OldName+'%' OR X.[Feb Complement (At Work)]   LIKE '%'+@OldName+'%' OR X.[Feb Leave Complement]   LIKE '%'+@OldName+'%' OR X.[Feb Complement (In Service)]   LIKE '%'+@OldName+'%' OR X.[Mar Percentage Adjustment]   LIKE '%'+@OldName+'%' OR X.[Mar Complement Adjustment]   LIKE '%'+@OldName+'%' OR X.[Mar Complement (At Work)]   LIKE '%'+@OldName+'%' OR X.[Mar Leave Complement]   LIKE '%'+@OldName+'%' OR X.[Mar Complement (In Service)]   LIKE '%'+@OldName+'%' OR X.[Apr Percentage Adjustment]   LIKE '%'+@OldName+'%' OR X.[Apr Complement Adjustment]   LIKE '%'+@OldName+'%' OR X.[Apr Complement (At Work)]   LIKE '%'+@OldName+'%' OR X.[Apr Leave Complement]   LIKE '%'+@OldName+'%' OR X.[Apr Complement (In Service)]   LIKE '%'+@OldName+'%' OR X.[May Percentage Adjustment]   LIKE '%'+@OldName+'%' OR X.[May Complement Adjustment]   LIKE '%'+@OldName+'%' OR X.[May Complement (At Work)]   LIKE '%'+@OldName+'%' OR X.[May Leave Complement]   LIKE '%'+@OldName+'%' OR X.[May Complement (In Service)]   LIKE '%'+@OldName+'%' OR X.[Jun Percentage Adjustment]   LIKE '%'+@OldName+'%' OR X.[Jun Complement Adjustment]   LIKE '%'+@OldName+'%' OR X.[Jun Complement (At Work)]   LIKE '%'+@OldName+'%' OR X.[Jun Leave Complement]   LIKE '%'+@OldName+'%' OR X.[Jun Complement (In Service)]   LIKE '%'+@OldName+'%' OR X.[Approved - Gang Level]   LIKE '%'+@OldName+'%' OR X.[GFL Approval]   LIKE '%'+@OldName+'%' OR X.[Org Unit - Gang]   LIKE '%'+@OldName+'%' OR X.[Jul Complement Adjustment]   LIKE '%'+@OldName+'%' OR X.[Jul Percentage Adjustment]   LIKE '%'+@OldName+'%';

 --03	-Note: No results for GFPS
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------



 INSERT INTO [Oug Budgeted Complement Revised Plan] ([Resource Tag], [Start Date], [End Date], [Designation], [Previous Revised Complement (At Work)], [Revised Complement (At Work)], [Leave Complement Percentage - Revised Plan], [Leave Complement - Revised Plan], [Leave Complement Override - Revised Plan], [Revised Plan Comments], [Org Unit - Gang], [ARMS Process Status], [ARMS Process ID])

 SELECT RX.[Resource Tag],X.[Start Date],X.[End Date],REPLACE(X.[Designation], @OldName, @NewName), X.[Previous Revised Complement (At Work)],X.[Revised Complement (At Work)],X.[Leave Complement Percentage - Revised Plan],X.[Leave Complement - Revised Plan],X.[Leave Complement Override - Revised Plan],REPLACE(X.[Revised Plan Comments], @OldName, @NewName), REPLACE(X.[Org Unit - Gang], @OldName, @NewName), REPLACE(X.[ARMS Process Status], @OldName, @NewName), X.[ARMS Process ID]
 FROM [Oug Budgeted Complement Revised Plan] X JOIN [Resource] R ON X.[Resource Tag] = R.[Resource Tag] JOIN [Resource] RX ON RX.[Resource Reference] = REPLACE(R.[Resource Reference], @OldName, @NewName)
 WHERE R.[Resource Reference] LIKE '%'+@OldName+'%' OR X.[Start Date]   LIKE '%'+@OldName+'%' OR X.[End Date]   LIKE '%'+@OldName+'%' OR X.[Designation]   LIKE '%'+@OldName+'%' OR X.[Previous Revised Complement (At Work)]   LIKE '%'+@OldName+'%' OR X.[Revised Complement (At Work)]   LIKE '%'+@OldName+'%' OR X.[Leave Complement Percentage - Revised Plan]   LIKE '%'+@OldName+'%' OR X.[Leave Complement - Revised Plan]   LIKE '%'+@OldName+'%' OR X.[Leave Complement Override - Revised Plan]   LIKE '%'+@OldName+'%' OR X.[Revised Plan Comments]   LIKE '%'+@OldName+'%' OR X.[Org Unit - Gang]   LIKE '%'+@OldName+'%' OR X.[ARMS Process Status]   LIKE '%'+@OldName+'%' OR X.[ARMS Process ID]   LIKE '%'+@OldName+'%'



 --04)	oug assignment no
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 INSERT INTO [oug assignment no] ([Resource Tag], [Assignment Number], [Start Date], [End Date], [Work Area], [Activity], [Account Number], [Account Activity], [Account Type], [Main Activity], [Sub Activity], [Description Activity], [Assignment Number Start Date], [Assignment Number End Date])
 SELECT RX.[Resource Tag],REPLACE(X.[Assignment Number], @OldName, @NewName), X.[Start Date],X.[End Date],REPLACE(X.[Work Area], @OldName, @NewName), REPLACE(X.[Activity], @OldName, @NewName), REPLACE(X.[Account Number], @OldName, @NewName), REPLACE(X.[Account Activity], @OldName, @NewName), REPLACE(X.[Account Type], @OldName, @NewName), REPLACE(X.[Main Activity], @OldName, @NewName), REPLACE(X.[Sub Activity], @OldName, @NewName), REPLACE(X.[Description Activity], @OldName, @NewName), X.[Assignment Number Start Date],X.[Assignment Number End Date]
 FROM [oug assignment no] X JOIN [Resource] R ON X.[Resource Tag] = R.[Resource Tag] JOIN [Resource] RX ON RX.[Resource Reference] = REPLACE(R.[Resource Reference], @OldName, @NewName)
 WHERE R.[Resource Reference] LIKE '%'+@OldName+'%' --OR X.[Assignment Number]   LIKE '%'+@OldName+'%' OR X.[Start Date]   LIKE '%'+@OldName+'%' OR X.[End Date]   LIKE '%'+@OldName+'%' OR X.[Work Area]   LIKE '%'+@OldName+'%' OR X.[Activity]   LIKE '%'+@OldName+'%' OR X.[Account Number]   LIKE '%'+@OldName+'%' OR X.[Account Activity]   LIKE '%'+@OldName+'%' OR X.[Account Type]   LIKE '%'+@OldName+'%' OR X.[Main Activity]   LIKE '%'+@OldName+'%' OR X.[Sub Activity]   LIKE '%'+@OldName+'%' OR X.[Description Activity]   LIKE '%'+@OldName+'%' OR X.[Assignment Number Start Date]   LIKE '%'+@OldName+'%' OR X.[Assignment Number End Date]   LIKE '%'+@OldName+'%'
 

 --05)
 UPDATE	x
	SET X.[Resource Tag] = RX.[Resource Tag]
 FROM [Opr Accommodation Inventory] X JOIN [Resource] R ON X.[Resource Tag] = R.[Resource Tag] JOIN [Resource] RX ON RX.[Resource Reference] = REPLACE(R.[Resource Reference], @OldName, @NewName)
 WHERE R.[Resource Reference] LIKE '%'+@OldName+'%' OR X.[Inventory Number]   LIKE '%'+@OldName+'%' OR X.[Accommodation Type]   LIKE '%'+@OldName+'%' OR X.[Property]   LIKE '%'+@OldName+'%' OR X.[Locality]   LIKE '%'+@OldName+'%' OR X.[If Other Specify]   LIKE '%'+@OldName+'%' OR X.[Accommodation Category]   LIKE '%'+@OldName+'%' OR X.[Stand Number]   LIKE '%'+@OldName+'%' OR X.[Physical Address Line 1]   LIKE '%'+@OldName+'%' OR X.[Physical Address Line 2]   LIKE '%'+@OldName+'%' OR X.[Physical Address Line 3]   LIKE '%'+@OldName+'%' OR X.[Physical Address Line 4]   LIKE '%'+@OldName+'%' OR X.[Physical Address Postal Code]   LIKE '%'+@OldName+'%' OR X.[Swimming Pool]   LIKE '%'+@OldName+'%' OR X.[Domestic Quarters]   LIKE '%'+@OldName+'%' OR X.[Alarm System]   LIKE '%'+@OldName+'%' OR X.[Bore Hole]   LIKE '%'+@OldName+'%' OR X.[Decoder]   LIKE '%'+@OldName+'%' OR X.[Satellite Dish]   LIKE '%'+@OldName+'%' OR X.[TV Antennae]   LIKE '%'+@OldName+'%' OR X.[Intercom Number]   LIKE '%'+@OldName+'%' OR X.[Telephone Number]   LIKE '%'+@OldName+'%' OR X.[Comments]   LIKE '%'+@OldName+'%' OR X.[Start Date]   LIKE '%'+@OldName+'%' OR X.[Single Quarters Name]   LIKE '%'+@OldName+'%' OR X.[Specify Other]   LIKE '%'+@OldName+'%' OR X.[Block Number/Name]   LIKE '%'+@OldName+'%' OR X.[Room Number / Bed Number]   LIKE '%'+@OldName+'%' OR X.[En Suite Bathroom]   LIKE '%'+@OldName+'%' OR X.[Operation]   LIKE '%'+@OldName+'%' OR X.[High Density Accommodation Name]   LIKE '%'+@OldName+'%' OR X.[Rented From]   LIKE '%'+@OldName+'%' OR X.[Water and Lights]   LIKE '%'+@OldName+'%' OR X.[Rented To]   LIKE '%'+@OldName+'%' OR X.[Rented From Operation]   LIKE '%'+@OldName+'%' OR X.[Previous Inventory Number]   LIKE '%'+@OldName+'%' OR X.[Unit]   LIKE '%'+@OldName+'%' OR X.[Room Number]   LIKE '%'+@OldName+'%' OR X.[Bed Number]   LIKE '%'+@OldName+'%' OR X.[Residential Address: Unit Number]   LIKE '%'+@OldName+'%' OR X.[Residential Address: Complex]   LIKE '%'+@OldName+'%' OR X.[Residential Address: Street Number]   LIKE '%'+@OldName+'%' OR X.[Residential Address: Street/Name of Farm]   LIKE '%'+@OldName+'%' OR X.[Residential Address: Suburb/District]   LIKE '%'+@OldName+'%' OR X.[Residential Address: City/Town]   LIKE '%'+@OldName+'%' OR X.[Residential Address: Postal Code]   LIKE '%'+@OldName+'%' OR X.[SARS Postal Address 1]   LIKE '%'+@OldName+'%' OR X.[SARS Postal Address 2]   LIKE '%'+@OldName+'%' OR X.[SARS Postal Address 3]   LIKE '%'+@OldName+'%' OR X.[SARS Postal Code]   LIKE '%'+@OldName+'%'

 --06
UPDATE	x
	SET X.[Resource Tag] = RX.[Resource Tag]
FROM [Opr MOC Number] X JOIN [Resource] R ON X.[Resource Tag] = R.[Resource Tag] JOIN [Resource] RX ON RX.[Resource Reference] = REPLACE(R.[Resource Reference], @OldName, @NewName)
WHERE R.[Resource Reference] LIKE '%'+@OldName+'%' OR X.[Mine Office Contract Number]   LIKE '%'+@OldName+'%' OR X.[Contracting Company Name]   LIKE '%'+@OldName+'%' OR X.[Start Date]   LIKE '%'+@OldName+'%' OR X.[End Date]   LIKE '%'+@OldName+'%' OR X.[Originator (Industry Number)]   LIKE '%'+@OldName+'%' OR X.[Originator (Name)]   LIKE '%'+@OldName+'%' OR X.[Originator (Designation)]   LIKE '%'+@OldName+'%' OR X.[Contract Type]   LIKE '%'+@OldName+'%' OR X.[Contract Activity]   LIKE '%'+@OldName+'%' OR X.[Contact Person]   LIKE '%'+@OldName+'%' OR X.[Contact Number]   LIKE '%'+@OldName+'%' OR R.[Resource Reference] LIKE '%'+@OldName+'%' OR R.[Resource Reference] LIKE '%'+@OldName+'%' OR X.[Structure Originator]   LIKE '%'+@OldName+'%' OR X.[Originator Operation]   LIKE '%'+@OldName+'%' OR X.[Operation]   LIKE '%'+@OldName+'%' OR X.[Contract Type 2]   LIKE '%'+@OldName+'%' OR X.[Company Registration Number]   LIKE '%'+@OldName+'%' OR X.[OC Abbrev Name]   LIKE '%'+@OldName+'%' OR X.[Specialised]   LIKE '%'+@OldName+'%' OR X.[Clocking]   LIKE '%'+@OldName+'%' OR X.[Plan]   LIKE '%'+@OldName+'%' OR X.[Current Labour Actual]   LIKE '%'+@OldName+'%' OR X.[Variance]   LIKE '%'+@OldName+'%' OR X.[Domain / Shaft]   LIKE '%'+@OldName+'%' OR X.[Domain Contact Person]   LIKE '%'+@OldName+'%' OR X.[Domain Contact Nr]   LIKE '%'+@OldName+'%' OR X.[Domain Email]   LIKE '%'+@OldName+'%' OR X.[Remarks]   LIKE '%'+@OldName+'%' OR X.[Validation]   LIKE '%'+@OldName+'%' OR X.[ID]   LIKE '%'+@OldName+'%'
AND X.[Start Date] > '01-Mar-2013'

--07)
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 INSERT INTO [Opr Course ] ([Resource Tag], [Discipline], [Course Name], [Description], [Course Type], [Course Master Start Date], [Course Master End Date], [Start Date], [End Date], [Start Time], [End Time], [Venue], [Room Name], [Seating Capacity], [Minimum Attendees], [Maximum Attendees], [Facilitator Name], [External Facilitator], [Venue Booked By], [Contact Number], [Course Duration], [Certificate to be Issued], [Cancellation Reason], [Cancellation Date], [Cancelled By Industry Number], [Cancelled by Name], [Comments], [Booking Cancellation Date], [Booking Course], [Employees Booked (Resource Tag)], [Employees Booked], [Booking End Date], [Facilitator Name Booked])
 SELECT RX.[Resource Tag],REPLACE(X.[Discipline], @OldName, @NewName), REPLACE(X.[Course Name], @OldName, @NewName), REPLACE(X.[Description], @OldName, @NewName), REPLACE(X.[Course Type], @OldName, @NewName), X.[Course Master Start Date],X.[Course Master End Date],X.[Start Date],X.[End Date],REPLACE(X.[Start Time], @OldName, @NewName), REPLACE(X.[End Time], @OldName, @NewName), REPLACE(X.[Venue], @OldName, @NewName), REPLACE(X.[Room Name], @OldName, @NewName), X.[Seating Capacity],X.[Minimum Attendees],X.[Maximum Attendees],REPLACE(X.[Facilitator Name], @OldName, @NewName), REPLACE(X.[External Facilitator], @OldName, @NewName), REPLACE(X.[Venue Booked By], @OldName, @NewName), REPLACE(X.[Contact Number], @OldName, @NewName), X.[Course Duration],REPLACE(X.[Certificate to be Issued], @OldName, @NewName), REPLACE(X.[Cancellation Reason], @OldName, @NewName), X.[Cancellation Date],REPLACE(X.[Cancelled By Industry Number], @OldName, @NewName), REPLACE(X.[Cancelled by Name], @OldName, @NewName), REPLACE(X.[Comments], @OldName, @NewName), X.[Booking Cancellation Date],REPLACE(X.[Booking Course], @OldName, @NewName), RX.[Resource Tag],REPLACE(X.[Employees Booked], @OldName, @NewName), X.[Booking End Date],REPLACE(X.[Facilitator Name Booked], @OldName, @NewName)
 FROM [Opr Course ] X JOIN [Resource] R ON X.[Resource Tag] = R.[Resource Tag] JOIN [Resource] RX ON RX.[Resource Reference] = REPLACE(R.[Resource Reference], @OldName, @NewName)
 WHERE R.[Resource Reference] LIKE '%'+@OldName+'%' OR X.[Discipline]   LIKE '%'+@OldName+'%' OR X.[Course Name]   LIKE '%'+@OldName+'%' OR X.[Description]   LIKE '%'+@OldName+'%' OR X.[Course Type]   LIKE '%'+@OldName+'%' OR X.[Course Master Start Date]   LIKE '%'+@OldName+'%' OR X.[Course Master End Date]   LIKE '%'+@OldName+'%' OR X.[Start Date]   LIKE '%'+@OldName+'%' OR X.[End Date]   LIKE '%'+@OldName+'%' OR X.[Start Time]   LIKE '%'+@OldName+'%' OR X.[End Time]   LIKE '%'+@OldName+'%' OR X.[Venue]   LIKE '%'+@OldName+'%' OR X.[Room Name]   LIKE '%'+@OldName+'%' OR X.[Seating Capacity]   LIKE '%'+@OldName+'%' OR X.[Minimum Attendees]   LIKE '%'+@OldName+'%' OR X.[Maximum Attendees]   LIKE '%'+@OldName+'%' OR X.[Facilitator Name]   LIKE '%'+@OldName+'%' OR X.[External Facilitator]   LIKE '%'+@OldName+'%' OR X.[Venue Booked By]   LIKE '%'+@OldName+'%' OR X.[Contact Number]   LIKE '%'+@OldName+'%' OR X.[Course Duration]   LIKE '%'+@OldName+'%' OR X.[Certificate to be Issued]   LIKE '%'+@OldName+'%' OR X.[Cancellation Reason]   LIKE '%'+@OldName+'%' OR X.[Cancellation Date]   LIKE '%'+@OldName+'%' OR X.[Cancelled By Industry Number]   LIKE '%'+@OldName+'%' OR X.[Cancelled by Name]   LIKE '%'+@OldName+'%' OR X.[Comments]   LIKE '%'+@OldName+'%' OR X.[Booking Cancellation Date]   LIKE '%'+@OldName+'%' OR X.[Booking Course]   LIKE '%'+@OldName+'%' OR R.[Resource Reference] LIKE '%'+@OldName+'%' OR X.[Employees Booked]   LIKE '%'+@OldName+'%' OR X.[Booking End Date]   LIKE '%'+@OldName+'%' OR X.[Facilitator Name Booked]   LIKE '%'+@OldName+'%'

--08)
UPDATE	x
	SET X.[Resource Tag] = RX.[Resource Tag]
 FROM [Opr Course Venues] X JOIN [Resource] R ON X.[Resource Tag] = R.[Resource Tag] JOIN [Resource] RX ON RX.[Resource Reference] = REPLACE(R.[Resource Reference], @OldName, @NewName)
 WHERE R.[Resource Reference] LIKE '%'+@OldName+'%' OR X.[Venue]   LIKE '%'+@OldName+'%' OR X.[Room Name]   LIKE '%'+@OldName+'%' OR X.[Contact Person]   LIKE '%'+@OldName+'%' OR X.[Fixtures]   LIKE '%'+@OldName+'%' OR X.[Flip Chart and Paper]   LIKE '%'+@OldName+'%' OR X.[Television]   LIKE '%'+@OldName+'%' OR X.[Video]   LIKE '%'+@OldName+'%' OR X.[White Board]   LIKE '%'+@OldName+'%' OR X.[Overhead Projector]   LIKE '%'+@OldName+'%' OR X.[Digital Projector]   LIKE '%'+@OldName+'%' OR X.[Screen]   LIKE '%'+@OldName+'%' OR X.[Contact Number]   LIKE '%'+@OldName+'%' OR X.[Operation]   LIKE '%'+@OldName+'%' OR X.[Course Booked]   LIKE '%'+@OldName+'%'

--09)
 INSERT INTO [Opr Unit Discipline] ([Resource Tag], [Operation], [Main Discipline Group], [Discipline], [Sub Discipline], [Reporting Discipline])
 SELECT RX.[Resource Tag],REPLACE(X.[Operation], @OldName, @NewName), REPLACE(X.[Main Discipline Group], @OldName, @NewName), REPLACE(X.[Discipline], @OldName, @NewName), REPLACE(X.[Sub Discipline], @OldName, @NewName), REPLACE(X.[Reporting Discipline], @OldName, @NewName)
 FROM [Opr Unit Discipline] X JOIN [Resource] R ON X.[Resource Tag] = R.[Resource Tag] JOIN [Resource] RX ON RX.[Resource Reference] = REPLACE(R.[Resource Reference], @OldName, @NewName)
 WHERE R.[Resource Reference] LIKE '%'+@OldName+'%' OR X.[Operation]   LIKE '%'+@OldName+'%' OR X.[Main Discipline Group]   LIKE '%'+@OldName+'%' OR X.[Discipline]   LIKE '%'+@OldName+'%' OR X.[Sub Discipline]   LIKE '%'+@OldName+'%' OR X.[Reporting Discipline]   LIKE '%'+@OldName+'%';

ENABLE TRIGGER ALL ON [Oug Budgeted Complement Business Plan];

ENABLE TRIGGER ALL ON [Oug Budgeted Complement Revised Plan];


 
GO
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


DECLARE @User VARCHAR(50), @IssueNumber VARCHAR(20), @ScriptName VARCHAR(100), @Description VARCHAR(500), @ChangeNumber VARCHAR(20)
DECLARE @IDENTITY INT, @SpecialInstructions VARCHAR(150), @DataChange Int, @sMsg varchar(4000), @LoggedBy NVARCHAR(50), @VerifiedBy NVARCHAR(50)
Declare @tbRT ResourceTagTableType, @FunctionalArea varchar(50), @ObjectType varchar(50), @ObjectName varchar(50), @Version	varchar(50)
SET @User = 'Jaco J v Vuuren'
SET @IssueNumber = 'SYM41057'
SET @ScriptName = 'SYM41057-304 JvV SGEO - Do Resoruce Tag Changes.sql'
SET @Description = 'Insert and Resource Tag Changes'
SET @DataChange = 1 -- 0 = Object 1=Data, 3=Data (priority change), 4=Object (priority change)
SET @FunctionalArea = 'Payroll'
SET @ObjectType = 'Table' -- 'TABLE', 'VIEW', 'STORED PROC','FUNCTION', 'INDEX', 'CONSTRAINT'
SET @ObjectName = 'Template Master' 
SET @Version = '2.4.2'
SET @SpecialInstructions = ''
SET @LoggedBy = 'Hannes Scheepers'
SET @VerifiedBy = 'Peet Schultz'
Set @Identity = -1

Exec SYMsp_SymplexityChangeCTRL 1, @User, @IssueNumber, @ScriptName, @Description, @DataChange, @FunctionalArea, @ObjectType, @ObjectName, @Version, @IDENTITY OUTPUT, @tbRT, @LoggedBy

GO
